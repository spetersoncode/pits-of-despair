name: hybrid
description: "BSP rooms with some cave-transformed sections"

dimensions:
  width: 80
  height: 70

passes:
  - pass: bsp
    priority: 0
    config:
      minPartitionSize: 10
      maxPartitionSize: 16
      minRoomWidth: 8
      maxRoomWidth: 14
      minRoomHeight: 8
      maxRoomHeight: 14
      corridorWidth: 2

  - pass: cellular_automata
    priority: 100
    config:
      role: modifier
      iterations: 4
      birthLimit: 4
      deathLimit: 3
      targetRegions:
        type: random
        count: 2
        filter:
          minArea: 64

  - pass: connectivity
    priority: 300
    config:
      repairStrategy: mst
      maxCorridorLength: 25

  - pass: validation
    priority: 400
    config:
      minWalkablePercent: 25
      maxWalkablePercent: 55

  - pass: metadata
    priority: 999
    config:
      minRegionSize: 16
      maxPassageWidth: 2

metadata:
  minRegionSize: 16
  maxPassageWidth: 2
  distanceFields:
    - walls
    - entrance
    - exit

# Layout-dependent spawn settings
spawnSettings:
  itemDensity: 0.009
  encounterChance: 0.42
  maxEncounterRatio: 0.36
  minEncounterSpacing: 7
  maxEncountersPerRegion: 1
  playerExclusionRadius: 14
  regionMatchMultiplier: 1.5
  dangerBonusMultiplier: 1.3
  minCreatureCount: 3

  # Mix of room and cave encounters
  encounterWeights:
    - id: lair
      weight: 25
    - id: ambush
      weight: 20
    - id: patrol
      weight: 20
    - id: guard
      weight: 15
    - id: treasure_guard
      weight: 10
    - id: swarm
      weight: 10
